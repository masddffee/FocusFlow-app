# FocusFlow MCP è‡ªå‹•åŒ–æ¸¬è©¦é…ç½®
# å®Œæ•´çš„ç«¯åˆ°ç«¯æ¸¬è©¦æµç¨‹ï¼ŒåŒ…å«è‡ªå‹•æˆªåœ–å’ŒéŒ¯èª¤æ•æ‰æ©Ÿåˆ¶
# 
# ç‰ˆæœ¬: 3.0
# ä½œè€…: FocusFlow Team
# æ›´æ–°æ—¥æœŸ: 2025-07-29

name: "FocusFlow MCP å®Œæ•´æ¸¬è©¦å¥—ä»¶"
version: "3.0"
description: "æ¶µè“‹æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½çš„è‡ªå‹•åŒ–æ¸¬è©¦ï¼ŒåŒ…å«æ™ºèƒ½ç”Ÿæˆã€å°ˆæ³¨è¨ˆæ™‚å™¨ã€çµ±è¨ˆå ±è¡¨ç­‰"

# æ¸¬è©¦ç’°å¢ƒé…ç½®
environment:
  baseUrl: "http://localhost:8081"
  backendUrl: "http://localhost:3001"
  timeout: 30000
  retries: 3
  screenshotPath: "./test-results/screenshots"
  videoPath: "./test-results/videos"
  reportPath: "./test-results/reports"

# ç€è¦½å™¨é…ç½®
browsers:
  - name: "chromium"
    enabled: true
    headless: false  # è¨­ç‚º false ä»¥ä¾¿è§€å¯Ÿæ¸¬è©¦éç¨‹
    viewport:
      width: 1280
      height: 720
    recordVideo: true
    trace: true

# æ¸¬è©¦æ•¸æ“š
testData:
  validTask:
    title: "å­¸ç¿’ React Native é–‹ç™¼"
    description: "å®Œæ•´å­¸ç¿’ React Native ç§»å‹•æ‡‰ç”¨é–‹ç™¼ï¼ŒåŒ…æ‹¬çµ„ä»¶é–‹ç™¼ã€ç‹€æ…‹ç®¡ç†ã€å°èˆªç­‰æ ¸å¿ƒæ¦‚å¿µ"
    dueDate: "2025-08-15"
    difficulty: "medium"
    priority: "high"
  
  complexTask:
    title: "å»ºç«‹å®Œæ•´çš„ AI å°è©±ç³»çµ±"
    description: "ä½¿ç”¨ Python å’Œæ©Ÿå™¨å­¸ç¿’æŠ€è¡“å»ºç«‹æ™ºèƒ½å°è©±ç³»çµ±ï¼ŒåŒ…å«è‡ªç„¶èªè¨€è™•ç†ã€æ„åœ–è­˜åˆ¥ã€å°è©±ç®¡ç†å’ŒéŸ¿æ‡‰ç”Ÿæˆ"
    dueDate: "2025-09-30"
    difficulty: "hard"
    priority: "high"

# æ¸¬è©¦æµç¨‹å®šç¾©
testSuites:
  
  # ğŸš€ æ¸¬è©¦å¥—ä»¶ 1: å‹•æ…‹å€‹äººåŒ–å•é¡Œç”Ÿæˆæ¸¬è©¦ (Phase 2 å„ªåŒ–é©—è­‰)
  - name: "dynamic-personalization-system"
    description: "é©—è­‰å‹•æ…‹å€‹äººåŒ–å•é¡Œç”Ÿæˆç³»çµ± (1-8 å•é¡Œè‡ªé©æ‡‰ç”Ÿæˆ)"
    priority: "critical"
    
    tests:
      - name: "01-simple-task-personalization"
        description: "ç°¡å–®ä»»å‹™å€‹äººåŒ–å•é¡Œç”Ÿæˆæ¸¬è©¦ (é æœŸ 1-3 å•é¡Œ)"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}/add-task"
            screenshot:
              name: "simple-task-start"
              
          - action: "fill"
            selector: "[data-testid='task-title-input']"
            value: "å­¸ç¿’åŸºç¤è‹±æ–‡å–®å­—"
            
          - action: "fill"
            selector: "[data-testid='task-description-input']"
            value: "æ¯å¤©èƒŒèª¦10å€‹æ–°å–®å­—"
            screenshot:
              name: "simple-task-filled"
              
          - action: "click"
            selector: "[data-testid='smart-generate-button']"
            
          - action: "waitForSelector"
            selector: "[data-testid='personalization-modal']"
            timeout: 15000
            screenshot:
              name: "simple-task-personalization-modal"
              
          - action: "verify"
            type: "elementCount"
            selector: "[data-testid='question-item']"
            expectedCount: { min: 1, max: 3 }
            errorMessage: "ç°¡å–®ä»»å‹™å€‹äººåŒ–å•é¡Œæ•¸é‡ä¸åœ¨é æœŸç¯„åœ (1-3 å€‹)"
            screenshot:
              name: "simple-task-question-count"
              onError: true
              
          - action: "verifyTransparency"
            checks:
              - hasQuestionRationale: true
              - hasComplexityExplanation: true
              - hasSufficiencyScore: true
            screenshot:
              name: "simple-task-transparency"
              onError: true

      - name: "02-complex-task-personalization" 
        description: "è¤‡é›œä»»å‹™å€‹äººåŒ–å•é¡Œç”Ÿæˆæ¸¬è©¦ (é æœŸ 6-8 å•é¡Œ)"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}/add-task"
            screenshot:
              name: "complex-task-start"
              
          - action: "fill"
            selector: "[data-testid='task-title-input']"
            value: "{{ testData.complexTask.title }}"
            
          - action: "fill" 
            selector: "[data-testid='task-description-input']"
            value: "{{ testData.complexTask.description }}"
            screenshot:
              name: "complex-task-filled"
              
          - action: "click"
            selector: "[data-testid='smart-generate-button']"
            
          - action: "waitForSelector"
            selector: "[data-testid='personalization-modal']"
            timeout: 15000
            screenshot:
              name: "complex-task-personalization-modal"
              
          - action: "verify"
            type: "elementCount"
            selector: "[data-testid='question-item']"
            expectedCount: { min: 6, max: 8 }
            errorMessage: "è¤‡é›œä»»å‹™å€‹äººåŒ–å•é¡Œæ•¸é‡ä¸åœ¨é æœŸç¯„åœ (6-8 å€‹)"
            screenshot:
              name: "complex-task-question-count"
              onError: true
              
          - action: "verifyQuestionQuality"
            checks:
              - hasDiagnosticQuestions: true
              - hasSkillAssessment: true  
              - hasTimeConstraintQuestions: true
              - hasPreferenceQuestions: true
            screenshot:
              name: "complex-task-question-quality"
              onError: true

      - name: "03-medium-task-personalization"
        description: "ä¸­ç­‰ä»»å‹™å€‹äººåŒ–å•é¡Œç”Ÿæˆæ¸¬è©¦ (é æœŸ 3-5 å•é¡Œ)"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}/add-task"
            screenshot:
              name: "medium-task-start"
              
          - action: "fill"
            selector: "[data-testid='task-title-input']"
            value: "{{ testData.validTask.title }}"
            
          - action: "fill"
            selector: "[data-testid='task-description-input']"
            value: "{{ testData.validTask.description }}"
            screenshot:
              name: "medium-task-filled"
              
          - action: "click"
            selector: "[data-testid='smart-generate-button']"
            
          - action: "waitForSelector"
            selector: "[data-testid='personalization-modal']"
            timeout: 15000
            screenshot:
              name: "medium-task-personalization-modal"
              
          - action: "verify"
            type: "elementCount"
            selector: "[data-testid='question-item']"
            expectedCount: { min: 3, max: 5 }
            errorMessage: "ä¸­ç­‰ä»»å‹™å€‹äººåŒ–å•é¡Œæ•¸é‡ä¸åœ¨é æœŸç¯„åœ (3-5 å€‹)"
            screenshot:
              name: "medium-task-question-count"
              onError: true

  # ğŸš€ æ¸¬è©¦å¥—ä»¶ 2: åˆ†æ®µå¼ç”Ÿæˆæ€§èƒ½å„ªåŒ–æ¸¬è©¦ (Phase 4 å„ªåŒ–é©—è­‰)
  - name: "segmented-generation-performance"
    description: "é©—è­‰åˆ†æ®µå¼ç”Ÿæˆç³»çµ±æ€§èƒ½å„ªåŒ– (æ¡†æ¶â†’å±•é–‹â†’å€‹äººåŒ–)"
    priority: "high"
    
    tests:
      - name: "01-segmented-generation-progress"
        description: "åˆ†æ®µå¼ç”Ÿæˆé€²åº¦è¿½è¹¤æ¸¬è©¦"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}/add-task"
            
          - action: "fill"
            selector: "[data-testid='task-title-input']"
            value: "{{ testData.complexTask.title }}"
            
          - action: "fill"
            selector: "[data-testid='task-description-input']"
            value: "{{ testData.complexTask.description }}"
            
          - action: "fillQuestions"  
            answers:
              experience: "beginner"
              timeAvailable: "1-2 hours daily"
              learningStyle: "structured learning"
            screenshot:
              name: "complex-personalization-completed"
              
          - action: "click"
            selector: "[data-testid='complete-personalization-button']"
            
          - action: "waitForSelector"
            selector: "[data-testid='generation-progress-modal']"
            timeout: 5000
            screenshot:
              name: "progress-modal-appeared"
              
          - action: "verifyProgressStages"
            expectedStages:
              - name: "framework"
                message: "æ­£åœ¨ç”Ÿæˆå­¸ç¿’æ¡†æ¶"
                expectedProgress: { min: 10, max: 30 }
              - name: "details"
                message: "æ­£åœ¨å±•é–‹"
                expectedProgress: { min: 30, max: 70 }
              - name: "personalization"
                message: "æ‡‰ç”¨å€‹äººåŒ–èª¿æ•´"
                expectedProgress: { min: 80, max: 95 }
              - name: "complete"
                message: "å­ä»»å‹™ç”Ÿæˆå®Œæˆ"
                expectedProgress: 100
            screenshot:
              name: "progress-stages-verified"
              onError: true
              
          - action: "measurePerformance"
            metric: "totalGenerationTime"
            expectedMax: 25000  # 25ç§’å…§å®Œæˆ (æ¯”åŸä¾†40-60ç§’å¿«)
            screenshot:
              name: "performance-measurement"
              onError: true

      - name: "02-performance-monitoring-integration"
        description: "æ€§èƒ½ç›£æ§å„€è¡¨æ¿æ•´åˆæ¸¬è©¦"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}/profile"
            
          - action: "scrollToElement"
            selector: "[data-testid='performance-monitor-button']"
            
          - action: "click"
            selector: "[data-testid='performance-monitor-button']"
            screenshot:
              name: "performance-monitor-opened"
              
          - action: "waitForSelector"
            selector: "[data-testid='performance-metrics-container']"
            timeout: 5000
            
          - action: "verifyPerformanceMetrics"
            expectedMetrics:
              - name: "AI éŸ¿æ‡‰æ™‚é–“"
                unit: "ms"
                expectedMax: 2000
              - name: "å­ä»»å‹™ç”Ÿæˆé€Ÿåº¦"
                unit: "tasks/min"
                expectedMin: 6.0
              - name: "ç”¨æˆ¶æµç¨‹å®Œæˆç‡"
                unit: "%"
                expectedMin: 80
              - name: "éŒ¯èª¤ç™¼ç”Ÿç‡"
                unit: "%"
                expectedMax: 5
            screenshot:
              name: "performance-metrics-verified"
              onError: true
              
          - action: "click"
            selector: "[data-testid='refresh-metrics-button']"
            
          - action: "waitForUpdate"
            selector: "[data-testid='performance-metrics-container']"
            timeout: 3000
            screenshot:
              name: "metrics-refreshed"

  # ğŸš€ æ¸¬è©¦å¥—ä»¶ 3: æ’ç¨‹åŒæ­¥ç³»çµ±æ¸¬è©¦ (Phase 3 å„ªåŒ–é©—è­‰)
  - name: "scheduling-synchronization"
    description: "é©—è­‰ä»»å‹™æ’ç¨‹èˆ‡ scheduledTasks ç‹€æ…‹åŒæ­¥"
    priority: "high"
    
    tests:
      - name: "01-task-scheduling-flow"
        description: "å®Œæ•´ä»»å‹™æ’ç¨‹æµç¨‹æ¸¬è©¦"
        steps:
          - action: "createTaskWithScheduling"
            taskData:
              title: "æ¸¬è©¦æ’ç¨‹ä»»å‹™"
              description: "ç”¨æ–¼é©—è­‰æ’ç¨‹åŒæ­¥åŠŸèƒ½"
              enableScheduling: true
            screenshot:
              name: "task-with-scheduling-created"
              
          - action: "navigate"
            target: "{{ environment.baseUrl }}/tasks"
            
          - action: "waitForSelector"
            selector: "[data-testid='scheduled-tasks-section']"
            timeout: 5000
            
          - action: "verify"
            type: "elementVisible"
            selector: "[data-testid='scheduled-task-item']"
            errorMessage: "æ’ç¨‹ä»»å‹™æœªåœ¨ä»»å‹™åˆ—è¡¨ä¸­é¡¯ç¤º"
            screenshot:
              name: "scheduled-task-visible"
              onError: true
              
          - action: "verifyScheduleSync"
            checks:
              - taskStoreHasTask: true
              - scheduledTasksHasEntry: true
              - idsMatch: true
              - timeSlotsMatch: true
            screenshot:
              name: "schedule-sync-verified"
              onError: true

      - name: "02-subtask-scheduling-sync"
        description: "å­ä»»å‹™æ’ç¨‹åŒæ­¥æ¸¬è©¦"
        steps:
          - action: "createComplexTask"
            withSubtasks: true
            enableScheduling: true
            
          - action: "navigate"
            target: "{{ environment.baseUrl }}/tasks"
            
          - action: "expandTask"
            selector: "[data-testid='complex-task-item']"
            
          - action: "verifySubtaskSchedules"
            checks:
              - hasScheduledSubtasks: true
              - subtaskIdsCorrect: true
              - parentTaskIdCorrect: true
              - timeSlotAssignments: true
            screenshot:
              name: "subtask-schedules-verified"
              onError: true
              
          - action: "markSubtaskComplete"
            subtaskIndex: 0
            
          - action: "verifyScheduleCleanup"
            checks:
              - completedSubtaskScheduleRemoved: true
              - remainingSchedulesIntact: true
            screenshot:
              name: "schedule-cleanup-verified"
              onError: true

  # æ¸¬è©¦å¥—ä»¶ 4: æ ¸å¿ƒåŠŸèƒ½æµç¨‹æ¸¬è©¦
  - name: "complete-user-journey"
    description: "å®Œæ•´çš„ç”¨æˆ¶ä½¿ç”¨æµç¨‹æ¸¬è©¦"
    priority: "critical"
    
    tests:
      - name: "01-application-startup"
        description: "æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•å’Œåˆå§‹åŒ–æ¸¬è©¦"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}"
            timeout: 10000
            screenshot:
              name: "app-startup"
              description: "æ‡‰ç”¨ç¨‹å¼é¦–æ¬¡è¼‰å…¥ç•«é¢"
          
          - action: "waitForSelector"
            selector: "[data-testid='main-container']"
            timeout: 5000
            
          - action: "verify"
            type: "elementVisible"
            selector: "[data-testid='add-task-button']"
            errorMessage: "ä¸»è¦ä»»å‹™æŒ‰é’®æœªé¡¯ç¤º"
            screenshot:
              name: "main-interface-loaded"
              onError: true

      - name: "02-task-creation-flow"
        description: "ä»»å‹™å‰µå»ºå®Œæ•´æµç¨‹æ¸¬è©¦"
        steps:
          - action: "click"
            selector: "[data-testid='add-task-button']"
            screenshot:
              name: "task-creation-start"
              description: "é»æ“Šå‰µå»ºä»»å‹™æŒ‰éˆ•"
          
          - action: "waitForSelector"
            selector: "[data-testid='task-form']"
            timeout: 3000
            
          - action: "fill"
            selector: "[data-testid='task-title-input']"
            value: "{{ testData.validTask.title }}"
            
          - action: "fill"
            selector: "[data-testid='task-description-input']"
            value: "{{ testData.validTask.description }}"
            screenshot:
              name: "task-form-filled"
              description: "ä»»å‹™è¡¨å–®å¡«å¯«å®Œæˆ"
          
          - action: "click"
            selector: "[data-testid='smart-generate-button']"
            screenshot:
              name: "smart-generate-clicked"
              description: "é»æ“Šæ™ºèƒ½ç”ŸæˆæŒ‰éˆ•"
          
          - action: "waitForResponse"
            urlPattern: "**/api/ai/**"
            timeout: 30000
            errorHandling:
              onTimeout:
                screenshot:
                  name: "ai-request-timeout"
                  description: "AI è«‹æ±‚è¶…æ™‚"
                action: "halt"
                
          - action: "waitForSelector"
            selector: "[data-testid='personalization-modal']"
            timeout: 10000
            screenshot:
              name: "personalization-modal-appeared"
              description: "å€‹äººåŒ–å•é¡Œå½ˆçª—å‡ºç¾"

      - name: "03-personalization-questions"
        description: "å€‹äººåŒ–å•é¡Œå›ç­”æµç¨‹"
        steps:
          - action: "verify"
            type: "elementCount"
            selector: "[data-testid='question-item']"
            expectedCount: { min: 3, max: 8 }
            errorMessage: "å€‹äººåŒ–å•é¡Œæ•¸é‡ä¸åœ¨é æœŸç¯„åœå…§"
            
          - action: "fillQuestions"
            strategy: "comprehensive"  # å®Œæ•´å›ç­”æ‰€æœ‰å•é¡Œ
            answers:
              experience: "intermediate"
              timeAvailable: "2-3 hours daily"
              learningStyle: "hands-on practice"
              goal: "build production applications"
            screenshot:
              name: "questions-answered"
              description: "å€‹äººåŒ–å•é¡Œå›ç­”å®Œæˆ"
              
          - action: "click"
            selector: "[data-testid='complete-personalization-button']"
            screenshot:
              name: "personalization-submitted"
              description: "æäº¤å€‹äººåŒ–å•é¡Œ"

      - name: "04-subtask-generation-verification"
        description: "å­ä»»å‹™ç”Ÿæˆçµæœé©—è­‰"
        steps:
          - action: "waitForSelector"
            selector: "[data-testid='subtasks-container']"
            timeout: 45000  # AI ç”Ÿæˆå¯èƒ½éœ€è¦è¼ƒé•·æ™‚é–“
            screenshot:
              name: "subtasks-generating"
              description: "ç­‰å¾…å­ä»»å‹™ç”Ÿæˆ"
              
          - action: "verify"
            type: "elementCount"
            selector: "[data-testid='subtask-item']"
            expectedCount: { min: 5, max: 15 }
            errorMessage: "ç”Ÿæˆçš„å­ä»»å‹™æ•¸é‡ç•°å¸¸"
            screenshot:
              name: "subtasks-generated"
              description: "å­ä»»å‹™ç”Ÿæˆå®Œæˆ"
              
          - action: "verifySubtaskQuality"
            checks:
              - hasTitle: true
              - hasDescription: true
              - hasDuration: true
              - hasDifficulty: true
              - hasOrder: true
            screenshot:
              name: "subtask-quality-check"
              onError: true
              
          - action: "click"
            selector: "[data-testid='save-task-button']"
            screenshot:
              name: "task-saved"
              description: "ä»»å‹™ä¿å­˜æˆåŠŸ"

  # æ¸¬è©¦å¥—ä»¶ 2: å°ˆæ³¨è¨ˆæ™‚å™¨åŠŸèƒ½æ¸¬è©¦  
  - name: "focus-timer-functionality"
    description: "å°ˆæ³¨è¨ˆæ™‚å™¨æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦"
    priority: "high"
    
    tests:
      - name: "01-timer-initialization"
        description: "è¨ˆæ™‚å™¨åˆå§‹åŒ–æ¸¬è©¦"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}/focus"
            screenshot:
              name: "focus-page-loaded"
              
          - action: "verify"
            type: "elementVisible"
            selector: "[data-testid='timer-display']"
            
          - action: "verify"
            type: "textContent"
            selector: "[data-testid='timer-display']"
            expectedText: "25:00"
            errorMessage: "è¨ˆæ™‚å™¨åˆå§‹æ™‚é–“ä¸æ­£ç¢º"

      - name: "02-timer-start-and-pause"
        description: "è¨ˆæ™‚å™¨å•Ÿå‹•å’Œæš«åœæ¸¬è©¦"
        steps:
          - action: "click"
            selector: "[data-testid='start-timer-button']"
            screenshot:
              name: "timer-started"
              
          - action: "wait"
            duration: 3000  # ç­‰å¾…3ç§’è§€å¯Ÿè¨ˆæ™‚å™¨é‹è¡Œ
            
          - action: "verify"
            type: "textContent"
            selector: "[data-testid='timer-display']"
            expectedText: "24:57"
            tolerance: 2000  # å…è¨±2ç§’èª¤å·®
            screenshot:
              name: "timer-counting-down"
              
          - action: "click"
            selector: "[data-testid='pause-timer-button']"
            screenshot:
              name: "timer-paused"
              
          - action: "wait"
            duration: 2000
            
          - action: "verifyTimerPaused"
            screenshot:
              name: "timer-pause-verified"
              onError: true

  # æ¸¬è©¦å¥—ä»¶ 3: çµ±è¨ˆå ±è¡¨åŠŸèƒ½æ¸¬è©¦
  - name: "statistics-and-analytics"
    description: "çµ±è¨ˆå ±è¡¨å’Œåˆ†æåŠŸèƒ½æ¸¬è©¦"
    priority: "medium"
    
    tests:
      - name: "01-stats-page-navigation"
        description: "çµ±è¨ˆé é¢å°èˆªæ¸¬è©¦"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}/stats"
            screenshot:
              name: "stats-page-loaded"
              
          - action: "waitForSelector"
            selector: "[data-testid='stats-container']"
            
          - action: "verify"
            type: "elementVisible"
            selector: "[data-testid='productivity-chart']"
            screenshot:
              name: "productivity-chart-visible"

      - name: "02-data-visualization"
        description: "æ•¸æ“šè¦–è¦ºåŒ–æ¸¬è©¦"
        steps:
          - action: "verifyChartData"
            chartSelector: "[data-testid='productivity-chart']"
            expectedDataPoints: { min: 1 }
            screenshot:
              name: "chart-data-verified"
              
          - action: "interactWithChart"
            chartSelector: "[data-testid='productivity-chart']"
            interaction: "hover"
            screenshot:
              name: "chart-interaction"

  # æ¸¬è©¦å¥—ä»¶ 4: éŒ¯èª¤è™•ç†å’Œé‚Šç•Œæƒ…æ³æ¸¬è©¦
  - name: "error-handling-and-edge-cases"
    description: "éŒ¯èª¤è™•ç†å’Œé‚Šç•Œæƒ…æ³æ¸¬è©¦"
    priority: "high"
    
    tests:
      - name: "01-invalid-input-handling"
        description: "ç„¡æ•ˆè¼¸å…¥è™•ç†æ¸¬è©¦"
        steps:
          - action: "navigate"
            target: "{{ environment.baseUrl }}/add-task"
            
          - action: "fill"
            selector: "[data-testid='task-title-input']"
            value: ""  # ç©ºæ¨™é¡Œ
            
          - action: "click"
            selector: "[data-testid='smart-generate-button']"
            
          - action: "verify"
            type: "elementVisible"
            selector: "[data-testid='error-message']"
            screenshot:
              name: "empty-title-error"
              
          - action: "fill"
            selector: "[data-testid='task-title-input']"
            value: "a"  # éçŸ­æ¨™é¡Œ
            
          - action: "click"
            selector: "[data-testid='smart-generate-button']"
            
          - action: "verify"
            type: "elementVisible"
            selector: "[data-testid='quality-alert']"
            screenshot:
              name: "quality-alert-shown"

      - name: "02-network-error-simulation"
        description: "ç¶²è·¯éŒ¯èª¤æ¨¡æ“¬æ¸¬è©¦"
        steps:
          - action: "interceptNetworkRequests"
            pattern: "**/api/ai/**"
            response:
              status: 500
              body: { error: "Internal Server Error" }
              
          - action: "fill"
            selector: "[data-testid='task-title-input']"
            value: "{{ testData.validTask.title }}"
            
          - action: "click"
            selector: "[data-testid='smart-generate-button']"
            
          - action: "waitForSelector"
            selector: "[data-testid='error-dialog']"
            timeout: 10000
            screenshot:
              name: "network-error-dialog"
              
          - action: "verify"
            type: "textContent"
            selector: "[data-testid='error-message']"
            contains: "network"
            screenshot:
              name: "network-error-message"

# å…¨åŸŸéŒ¯èª¤è™•ç†é…ç½®
errorHandling:
  
  # è‡ªå‹•æˆªåœ–è¨­å®š
  autoScreenshot:
    enabled: true
    onError: true
    onTimeout: true
    onAssertion: true
    quality: 90
    fullPage: true
    
  # éŒ¯èª¤æ¢å¾©ç­–ç•¥
  recovery:
    enabled: true
    strategies:
      - type: "refresh"
        condition: "navigation_timeout"
        maxAttempts: 2
        
      - type: "restart"
        condition: "critical_error"
        maxAttempts: 1
        
      - type: "skip"
        condition: "non_critical_error"
        
  # æ—¥èªŒé…ç½®
  logging:
    level: "detailed"
    includeScreenshots: true
    includeNetworkLogs: true
    includeConsoleErrors: true
    
  # é€šçŸ¥è¨­å®š
  notifications:
    onCriticalError: true
    onTestComplete: true
    channels:
      - type: "console"
      - type: "file"
        path: "./test-results/error-log.json"

# å ±å‘Šç”Ÿæˆé…ç½®
reporting:
  formats:
    - "html"
    - "json"
    - "junit"
    
  html:
    title: "FocusFlow MCP æ¸¬è©¦å ±å‘Š"
    includeScreenshots: true
    includeVideos: true
    theme: "dark"
    
  customMetrics:
    - name: "AI éŸ¿æ‡‰æ™‚é–“"
      description: "AI API å¹³å‡éŸ¿æ‡‰æ™‚é–“"
      unit: "ms"
      threshold: 2000
      
    - name: "ä»»å‹™ç”ŸæˆæˆåŠŸç‡"
      description: "æ™ºèƒ½ä»»å‹™ç”ŸæˆæˆåŠŸç‡"
      unit: "%"
      threshold: 90
      
    - name: "ç”¨æˆ¶æµç¨‹å®Œæˆæ™‚é–“"
      description: "å®Œæ•´ç”¨æˆ¶æµç¨‹å¹³å‡å®Œæˆæ™‚é–“"
      unit: "seconds"
      threshold: 30
      
    # ğŸš€ Phase å„ªåŒ–æ–°å¢æŒ‡æ¨™
    - name: "å‹•æ…‹å•é¡Œç”Ÿæˆæº–ç¢ºåº¦"
      description: "å€‹äººåŒ–å•é¡Œæ•¸é‡æ˜¯å¦ç¬¦åˆä»»å‹™è¤‡é›œåº¦é æœŸ"
      unit: "%"
      threshold: 85
      
    - name: "åˆ†æ®µå¼ç”Ÿæˆæ€§èƒ½æ”¹å–„"
      description: "ç›¸æ¯”å–®æ¬¡ç”Ÿæˆçš„æ€§èƒ½æå‡ç™¾åˆ†æ¯”"
      unit: "%"
      threshold: 30
      
    - name: "æ’ç¨‹åŒæ­¥ä¸€è‡´æ€§"
      description: "taskStore å’Œ scheduledTasks ç‹€æ…‹åŒæ­¥æº–ç¢ºç‡"
      unit: "%"
      threshold: 95
      
    - name: "é€æ˜åº¦åŠŸèƒ½å¯è¦‹æ€§"
      description: "AI æ±ºç­–é€æ˜åº¦å…ƒç´ çš„å¯è¦‹ç‡"
      unit: "%"
      threshold: 90
      
    - name: "å­ä»»å‹™æŒ‡å¼•å®Œæ•´æ€§"
      description: "å­ä»»å‹™åŒ…å«è¡Œå‹•æŒ‡å¼•çš„å®Œæ•´ç‡"
      unit: "%"
      threshold: 80

# æ€§èƒ½ç›£æ§é…ç½®
performance:
  enabled: true
  metrics:
    - "firstContentfulPaint"
    - "largestContentfulPaint"
    - "timeToInteractive"
    - "totalBlockingTime"
    
  thresholds:
    firstContentfulPaint: 2000  # 2ç§’å…§
    largestContentfulPaint: 4000  # 4ç§’å…§
    timeToInteractive: 5000  # 5ç§’å…§
    
  screenshot:
    onThresholdExceeded: true
    
# æ¸…ç†é…ç½®
cleanup:
  afterEach: true
  afterSuite: true
  actions:
    - "clearLocalStorage"
    - "clearSessionStorage"
    - "clearCookies"
    - "resetDatabase"  # å¦‚æœæœ‰æ¸¬è©¦æ•¸æ“šåº«

# ä¸¦è¡ŒåŸ·è¡Œé…ç½®
parallel:
  enabled: true
  workers: 2
  strategy: "suite"  # æŒ‰æ¸¬è©¦å¥—ä»¶ä¸¦è¡Œ
  
# é‡è©¦é…ç½®
retry:
  enabled: true
  maxAttempts: 2
  conditions:
    - "timeout"
    - "network_error"
    - "element_not_found"